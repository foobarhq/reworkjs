(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{gF0Q:function(e,t,l){"use strict";l.r(t),l.d(t,"_frontmatter",(function(){return i})),l.d(t,"default",(function(){return s}));l("5hJT"),l("W1QL"),l("K/PF"),l("t91x"),l("75LO"),l("PJhk"),l("mXGw");var n=l("SAVP"),r=l("TjRS");l("aD51");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e}).apply(this,arguments)}var i={};void 0!==i&&i&&i===Object(i)&&Object.isExtensible(i)&&!i.hasOwnProperty("__filemeta")&&Object.defineProperty(i,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"START.md"}});var b={_frontmatter:i},c=r.a;function s(e){var t=e.components,l=function(e,t){if(null==e)return{};var l,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)l=a[n],t.indexOf(l)>=0||(r[l]=e[l]);return r}(e,["components"]);return Object(n.b)(c,a({},b,l,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h1",{id:"rjs-start"},"rjs start"),Object(n.b)("p",null,"prod could simply delegate: a call to ",Object(n.b)("inlineCode",{parentName:"p"},"rjs build")," then call to ",Object(n.b)("inlineCode",{parentName:"p"},"rjs serve")),Object(n.b)("p",null,"dev must go through ",Object(n.b)("inlineCode",{parentName:"p"},"webpackDevMiddleware")," (server & client)"),Object(n.b)("h2",{id:"prod--ssr"},"prod + ssr"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"build client bundle + server bundle ONCE (call to ",Object(n.b)("inlineCode",{parentName:"li"},"NODE_ENV=production rjs build client server"),"?)"),Object(n.b)("li",{parentName:"ul"},"start SSR server (server bundle) (call to ",Object(n.b)("inlineCode",{parentName:"li"},"rjs serve --ssr"),"?)\n-- serves static files\n-- serves live routes if no static file found")),Object(n.b)("h2",{id:"prod-no-ssr"},"prod NO SSR"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"build client bundle ONCE (call to ",Object(n.b)("inlineCode",{parentName:"li"},"NODE_ENV=production rjs build client"),"?)"),Object(n.b)("li",{parentName:"ul"},"start static file server (call to ",Object(n.b)("inlineCode",{parentName:"li"},"rjs serve --no-ssr"),"?)\n-- serves static files\n-- serves index.html if no static file found")),Object(n.b)("h2",{id:"dev--ssr"},"dev + ssr"),Object(n.b)("p",null,"the special one: two servers (dev front, dev back)"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"get compile client & server with watch compilers"),Object(n.b)("li",{parentName:"ul"},"launch client\n-- launch webpackDevMiddleware & pass client compiler\n-- launch proxy to SSR server"),Object(n.b)("li",{parentName:"ul"},"launch SSR (bundle output, other process)\n-- wait for watch compiler to finish & start it\n-- restart it on hot reload")),Object(n.b)("h2",{id:"dev-no-ssr"},"dev NO ssr"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"compile client & server with watch (retrieve webpack compilers)"),Object(n.b)("li",{parentName:"ul"},"launch client\n-- launch webpackDevMiddleware & pass client webpack compiler\n-- serves index.html if no static file found")),Object(n.b)("h3",{id:"organisation"},"Organisation"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("inlineCode",{parentName:"li"},"framework/client"),":",Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Client Bundle Entry Point (React.render)"),Object(n.b)("li",{parentName:"ul"},"calls pre-init, React.render"))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("inlineCode",{parentName:"li"},"framework/server"),":",Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"[PROD SSR]"," Server Bundle Entry Point (express app)"),Object(n.b)("li",{parentName:"ul"},"calls pre-init, server-hooks, serveReactRoute"))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("inlineCode",{parentName:"li"},"internals/server"),":",Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"[PROD NO SSR]"," ",Object(n.b)("inlineCode",{parentName:"li"},"serve-no-ssr.js"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Fully static server (serves static files + fallback index.html)"))),Object(n.b)("li",{parentName:"ul"},"[DEV NO SSR]"," ",Object(n.b)("inlineCode",{parentName:"li"},"start-no-ssr.js"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"calls ",Object(n.b)("inlineCode",{parentName:"li"},"build client")," API"),Object(n.b)("li",{parentName:"ul"},"Starts Client server (once, webpackDevMiddleware)"),Object(n.b)("li",{parentName:"ul"},"fallback to index.html"))),Object(n.b)("li",{parentName:"ul"},"[DEV SSR]"," ",Object(n.b)("inlineCode",{parentName:"li"},"start-ssr.js"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"calls ",Object(n.b)("inlineCode",{parentName:"li"},"build client server --watch")," API (or ",Object(n.b)("inlineCode",{parentName:"li"},"build(client, server, watch: true)"),")"),Object(n.b)("li",{parentName:"ul"},"Starts Client server (once, webpackDevMiddleware)"),Object(n.b)("li",{parentName:"ul"},"Starts and hot reloads SSR server (sub-process, needs to be killable)")))))),Object(n.b)("h3",{id:"parallelism"},"Parallelism"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"parallel-webpack (each build in parallel - client/server) OR each compiler on their own process"),Object(n.b)("li",{parentName:"ul"},"thread-loader (parallel loaders, eg babel)?"),Object(n.b)("li",{parentName:"ul"},"dev only: SSR always on its own process, client on main process is fine.")),Object(n.b)("h3",{id:"reporting"},"Reporting"),Object(n.b)("p",null,"for split view (start command only):"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"limit split view to ","[client + builders]"," & ","[server]"),Object(n.b)("li",{parentName:"ul"},"add progress bar")),Object(n.b)("h3",{id:"unification"},"Unification"),Object(n.b)("p",null,"Building must be an internal api which looks like this:"),Object(n.b)("pre",null,Object(n.b)("code",a({parentName:"pre"},{className:"language-javascript"}),"function build(\n  sides: {\n    client: boolean,\n    server: boolean,\n  }, \n  opts: {\n    watch: boolean,\n    mode: 'PRODUCTION' | 'DEVELOPMENT',\n  },\n): { // out\n  client: { compiler: WebpackCompiler },\n  server: { compiler: WebpackCompiler },\n} {}\n")),Object(n.b)("h1",{id:"rjs-build"},"rjs build"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("inlineCode",{parentName:"li"},"rjs build client server --watch")," calls ",Object(n.b)("inlineCode",{parentName:"li"},"build")," function with watch + mode & enables IPC"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("inlineCode",{parentName:"li"},"rjs build client server")," calls ",Object(n.b)("inlineCode",{parentName:"li"},"build")," function with mode & exits with status code")),Object(n.b)("h1",{id:"rjs-serve"},"rjs serve"),Object(n.b)("p",null,Object(n.b)("em",{parentName:"p"},"PROD ONLY")),Object(n.b)("p",null,"WITH SSR: launches ",Object(n.b)("inlineCode",{parentName:"p"},".build/server/main.js"),"\nWITHOUT SSR: launches ",Object(n.b)("inlineCode",{parentName:"p"},"internals/server/serve-no-ssr.js")))}s&&s===Object(s)&&Object.isExtensible(s)&&!s.hasOwnProperty("__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"START.md"}}),s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---start-md-66ec7c8797d39341e9a8.js.map